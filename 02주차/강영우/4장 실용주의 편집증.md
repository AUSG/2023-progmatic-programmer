# 4장 실용주의 편집증

> 여러분은 완벽한 소프트웨어를 만들 수 없다.
> 
- 본인 자신을 믿지 말고, 실수에 대한 방어책을 계속 마련해라.
- 가정을 적극적으로 검증하는 코드를 작성해라

# Topic 23 계약에 의한 설계

- 소프트웨어 모듈이 서로 소통하는 것을 돕기 위해 “계약”을 사용할 수 있다.

## DBC (Design By Contract, 계약에 의한 설계)

- 프로그램의 정확성을 보장하기 위해 소프트웨어 모듈의 권리와 책임을 문서화하고 합의하는데 초점을 맞춘다.
- 소프트웨어 시스템의 모든 함수와 메서드는 뭔가를 하고 그 전제조건이 있고, 이후에는 무엇이 변한다.
    - 선행조건
        - 루틴의 요구사항
    - 후행조건
        - 루틴이 자기가 할 것이라고 보장하는 것
    - 클래스 불변식
        - 호출자의 입장에서 이 조건이 언제나 참인것을 클래스가 보장한다.
- 루틴과 그 루틴을 호출하려는 코드 간의 계약은 다음과 같다
    - 만약 모든 호출자가 루틴의 모든 선행 조건을 충족한다면 해당 루틴은 종료 시 모든 후행 조건과 불변식이 참이 되는 것을 보장한다.

> 계약으로 설계하라
> 
- 게으름뱅이 코드를 짜라
- TDD와 상관없이 DBC를 준수하라

# Topic 24 죽은 프로그램은 거짓말을 하지 않는다.

- 프로그램이 죽었을 때, “절대 그럴리 없어”라는 사고는 버려라.
- 오류를 정말 확인하고 천천히 들여다 보자

> 일찍 작동을 멈춰라
> 

# Topic 25 단정적 프로그래밍

- “그런일은 일어날 수 없어”라는 것은 없다!

> 단정문으로 불가능한 상황을 예방하라.
> 
- 그럼에도 절대 일어나지 않을 상황이 있다면 단정문(assertion)을 이용해 확인하는 코드를 추가하라
- 절대 단정문이 로직에 영향을 주어서는 안된다.
- 단정 기능을 켜두자
    - 정말 성능 문제가 있는 경우는 문제가 되는 단정문만 끄도록 하자.

<aside>
❓ 그러면 단정문을 실제 비즈니스 로직에 써야하는건가…..???? 테스트코드가 아니라??

</aside>

# Topic 26 리소스 사용의 균형

> 자신이 시작한 것은 자신이 끝내라
> 
- 일의 단위를 하나가 시작해서 그 스스로 종료해야한다. 다른 사이드 이펙트는 안된다!
- 잘 모르겠을때는 언제나 스코프를 줄이는 편이 낫다

> 지역적으로 행동하라
> 
- 리소스 할당의 기본패턴을 확장해서 한번에 여러 리소스를 사용하는 루틴에 적용하는 방법
    - 리소스를 할당한 순서의 역순으로 해체해야지 참조를 망가뜨리지 않는다.
    - 코드의 여러곳에서 동일한 구성의 리소스를 할당하는 경우에는 같은 순서로 할당해야 교착 가능성을 줄일 수 있다.
- 객체와 예외
    - 할당과 해제의 균형은 객체의 생성자와 소멸자에 대응된다.
    - 객체지향 언어로 프로그래밍할때 리소스를 클래스 안에 캡슐화하자.
- 균형잡기와 예외
    - 중간에 예외가 던져지면 지금까지 할당된 모든 것이 사라진다.
    - 사라지지 않는 경우에는 try-catch-finally에서 처리해주자

# Topic 27 헤드라이트를 앞서가지 말라

- 너무 먼 미래를 내다볼 수 없고, 정면에서 벗어난 영역일 수록 더 알기 힘들다.

> 작은 단계들을 밟아라. 언제나.
> 
- 언제나 작은 단계를 밟고, 피드백을 확인하라.

> 예언하지 말라.
>